<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎯 مركز التحكم الرئيسي - AzizSys</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e);
            color: #fff; 
            overflow-x: hidden;
        }
        .container { max-width: 1600px; margin: 0 auto; padding: 20px; }
        
        /* Header */
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            background: linear-gradient(135deg, #16213e, #0f3460);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,255,136,0.1);
        }
        .header h1 { 
            color: #00ff88; 
            font-size: 2.8em; 
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0,255,136,0.5);
        }
        .header p { color: #aaa; font-size: 1.2em; }
        
        /* Control Grid */
        .control-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); 
            gap: 25px; 
            margin-bottom: 30px;
        }
        
        /* Cards */
        .card { 
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-radius: 15px; 
            padding: 25px; 
            border: 1px solid #333;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0,255,136,0.1);
            border-color: #00ff88;
        }
        .card h3 { 
            color: #00ff88; 
            margin-bottom: 20px; 
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Buttons */
        .btn {
            background: linear-gradient(135deg, #00ff88, #00cc6a);
            color: #000;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        .btn:hover {
            background: linear-gradient(135deg, #00cc6a, #00aa55);
            transform: scale(1.05);
        }
        .btn-danger {
            background: linear-gradient(135deg, #ff4444, #cc3333);
            color: #fff;
        }
        .btn-warning {
            background: linear-gradient(135deg, #ffaa00, #cc8800);
            color: #000;
        }
        .btn-info {
            background: linear-gradient(135deg, #0099ff, #0077cc);
            color: #fff;
        }
        
        /* Status */
        .status {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            margin: 3px;
            font-weight: bold;
        }
        .status.online { background: #00ff88; color: #000; }
        .status.offline { background: #ff4444; color: #fff; }
        .status.warning { background: #ffaa00; color: #000; }
        
        /* Metrics */
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .metric {
            text-align: center;
            background: rgba(0,255,136,0.1);
            padding: 15px;
            border-radius: 10px;
        }
        .metric-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #00ff88;
            display: block;
        }
        .metric-label {
            font-size: 0.9em;
            color: #aaa;
            margin-top: 5px;
        }
        
        /* Logs */
        .log-container {
            background: #000;
            border-radius: 10px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border: 1px solid #333;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #00ff88;
            padding-left: 10px;
        }
        .log-time { color: #00ff88; }
        .log-level { font-weight: bold; }
        .log-error { border-left-color: #ff4444; }
        .log-warning { border-left-color: #ffaa00; }
        
        /* Refresh Button */
        .refresh-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #00ff88;
            color: #000;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0,255,136,0.3);
        }
        
        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        /* System Health */
        .health-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-block;
            margin-left: 10px;
        }
        .health-good { background: #00ff88; }
        .health-warning { background: #ffaa00; }
        .health-critical { background: #ff4444; }
    </style>
</head>
<body>
    <button class="refresh-btn" onclick="refreshAll()">🔄 تحديث شامل</button>
    
    <div class="container">
        <div class="header">
            <h1>🎯 مركز التحكم الرئيسي</h1>
            <p>مراقبة وإدارة شاملة لجميع أنظمة الإصلاح والتطوير</p>
            <div class="metrics">
                <div class="metric">
                    <span class="metric-value" id="systemHealth">95</span>
                    <span class="metric-label">صحة النظام %</span>
                </div>
                <div class="metric">
                    <span class="metric-value" id="activeTasks">3</span>
                    <span class="metric-label">مهام نشطة</span>
                </div>
                <div class="metric">
                    <span class="metric-value" id="completedToday">12</span>
                    <span class="metric-label">مكتمل اليوم</span>
                </div>
                <div class="metric">
                    <span class="metric-value" id="errorCount">1</span>
                    <span class="metric-label">أخطاء</span>
                </div>
            </div>
        </div>

        <div class="control-grid">
            <!-- System Control -->
            <div class="card">
                <h3>⚙️ التحكم في النظام <span class="health-indicator health-good"></span></h3>
                <div class="quick-actions">
                    <button class="btn" onclick="startAutoSystem()">🚀 تشغيل النظام التلقائي</button>
                    <button class="btn btn-warning" onclick="pauseSystem()">⏸️ إيقاف مؤقت</button>
                    <button class="btn btn-danger" onclick="emergencyStop()">🛑 إيقاف طارئ</button>
                </div>
                <div>
                    <span class="status online">EventBus: متصل</span>
                    <span class="status online">Orchestrator: يعمل</span>
                    <span class="status warning">Auto-Fix: معلق</span>
                </div>
            </div>

            <!-- AI Agents -->
            <div class="card">
                <h3>🤖 الوكلاء الذكيين</h3>
                <div class="quick-actions">
                    <button class="btn" onclick="activateGemini()">🧠 تفعيل Gemini AI</button>
                    <button class="btn" onclick="activateAmazonQ()">⚡ تفعيل Amazon Q</button>
                    <button class="btn btn-info" onclick="viewAILogs()">📋 سجلات الذكاء</button>
                </div>
                <div>
                    <span class="status online">Gemini AI: نشط</span>
                    <span class="status online">Amazon Q: جاهز</span>
                    <span class="status online">Coordination: متزامن</span>
                </div>
            </div>

            <!-- Scripts & Automation -->
            <div class="card">
                <h3>🔧 السكربتات والأتمتة</h3>
                <div class="quick-actions">
                    <button class="btn" onclick="runCleanup()">🧹 تنظيف النظام</button>
                    <button class="btn" onclick="quickUpdate()">⚡ تحديث سريع</button>
                    <button class="btn" onclick="installService()">⚙️ تثبيت كخدمة</button>
                    <button class="btn btn-info" onclick="runDailyMaintenance()">📅 صيانة يومية</button>
                </div>
                <div id="scriptStatus">
                    <span class="status online">Cleanup: جاهز</span>
                    <span class="status online">Update: جاهز</span>
                    <span class="status offline">Service: غير مثبت</span>
                </div>
            </div>

            <!-- Monitoring & Reports -->
            <div class="card">
                <h3>📊 المراقبة والتقارير</h3>
                <div class="quick-actions">
                    <button class="btn" onclick="openReportsCenter()">📋 مركز التقارير</button>
                    <button class="btn" onclick="viewDashboard()">📊 اللوحة المركزية</button>
                    <button class="btn btn-info" onclick="exportReports()">📤 تصدير التقارير</button>
                </div>
                <div>
                    <span class="status online">Reports: محدث</span>
                    <span class="status online">Dashboard: متاح</span>
                    <span class="status warning">Backup: قديم</span>
                </div>
            </div>
        </div>

        <!-- Live Logs -->
        <div class="card">
            <h3>📜 السجلات المباشرة</h3>
            <div class="log-container" id="liveLogs">
                <div class="log-entry">
                    <span class="log-time">[14:30:25]</span>
                    <span class="log-level">[INFO]</span>
                    <span>🚀 تم بدء النظام التلقائي بنجاح</span>
                </div>
                <div class="log-entry">
                    <span class="log-time">[14:30:30]</span>
                    <span class="log-level">[INFO]</span>
                    <span>🧠 Gemini AI: قراءة DAILY_BOOT.md</span>
                </div>
                <div class="log-entry">
                    <span class="log-time">[14:30:35]</span>
                    <span class="log-level">[INFO]</span>
                    <span>⚡ Amazon Q: استلام 3 مهام جديدة</span>
                </div>
                <div class="log-entry log-warning">
                    <span class="log-time">[14:30:40]</span>
                    <span class="log-level">[WARN]</span>
                    <span>⚠️ EventBus: تأخير في الاستجابة (2.5s)</span>
                </div>
                <div class="log-entry">
                    <span class="log-time">[14:30:45]</span>
                    <span class="log-level">[INFO]</span>
                    <span>✅ تم إكمال TASK-001 بنجاح</span>
                </div>
            </div>
        </div>
    </div>

    <script src="EventBus.js"></script>
    <script>
        // Global State
        let systemRunning = false;
        let autoRefresh = true;
        
        // EventBus Integration
        eventBus.on('system:status', (event) => {
            updateSystemStatus(event.data);
        });
        
        eventBus.on('task:progress', (event) => {
            addLog('INFO', `📋 ${event.data.message}`);
        });
        
        eventBus.on('ai:activity', (event) => {
            addLog('INFO', `🤖 ${event.data.agent}: ${event.data.activity}`);
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadSystemStatus();
            startAutoRefresh();
        });

        // System Control Functions
        function startAutoSystem() {
            systemRunning = true;
            addLog('INFO', '🚀 بدء تشغيل النظام التلقائي...');
            
            // Simulate system startup
            setTimeout(() => {
                addLog('INFO', '✅ تم تشغيل النظام بنجاح');
                updateMetric('systemHealth', 98);
                updateStatus();
            }, 2000);
        }

        function pauseSystem() {
            systemRunning = false;
            addLog('WARN', '⏸️ تم إيقاف النظام مؤقتاً');
            updateMetric('systemHealth', 75);
        }

        function emergencyStop() {
            systemRunning = false;
            addLog('ERROR', '🛑 إيقاف طارئ للنظام');
            updateMetric('systemHealth', 50);
            updateMetric('activeTasks', 0);
        }

        // AI Functions
        function activateGemini() {
            addLog('INFO', '🧠 تفعيل Gemini AI...');
            setTimeout(() => {
                addLog('INFO', '✅ Gemini AI نشط ويقرأ المستندات');
            }, 1500);
        }

        function activateAmazonQ() {
            addLog('INFO', '⚡ تفعيل Amazon Q...');
            setTimeout(() => {
                addLog('INFO', '✅ Amazon Q جاهز لاستقبال المهام');
            }, 1500);
        }

        function viewAILogs() {
            window.open('data:text/html,<h1>سجلات الذكاء الاصطناعي</h1><p>قريباً...</p>', '_blank');
        }

        // Script Functions
        function runCleanup() {
            addLog('INFO', '🧹 بدء تنظيف النظام...');
            setTimeout(() => {
                addLog('INFO', '✅ تم تنظيف 15 ملف قديم');
                updateMetric('systemHealth', Math.min(100, parseInt(document.getElementById('systemHealth').textContent) + 2));
            }, 3000);
        }

        function quickUpdate() {
            addLog('INFO', '⚡ بدء التحديث السريع...');
            setTimeout(() => {
                addLog('INFO', '✅ تم تحديث 8 مكونات');
                updateMetric('completedToday', parseInt(document.getElementById('completedToday').textContent) + 1);
            }, 2500);
        }

        function installService() {
            addLog('INFO', '⚙️ تثبيت النظام كخدمة Windows...');
            setTimeout(() => {
                addLog('INFO', '✅ تم تثبيت الخدمة بنجاح');
                document.getElementById('scriptStatus').innerHTML = `
                    <span class="status online">Cleanup: جاهز</span>
                    <span class="status online">Update: جاهز</span>
                    <span class="status online">Service: مثبت</span>
                `;
            }, 4000);
        }

        function runDailyMaintenance() {
            addLog('INFO', '📅 بدء الصيانة اليومية...');
            setTimeout(() => {
                addLog('INFO', '✅ اكتملت الصيانة اليومية');
                updateMetric('systemHealth', 100);
            }, 5000);
        }

        // Monitoring Functions
        function openReportsCenter() {
            window.open('../reports/index.html', '_blank');
        }

        function viewDashboard() {
            window.open('COMPREHENSIVE_DASHBOARD.html', '_blank');
        }

        function exportReports() {
            addLog('INFO', '📤 تصدير التقارير...');
            setTimeout(() => {
                addLog('INFO', '✅ تم تصدير 5 تقارير');
            }, 2000);
        }

        // Utility Functions
        function addLog(level, message) {
            const logsContainer = document.getElementById('liveLogs');
            const time = new Date().toLocaleTimeString('ar-SA');
            const logClass = level === 'ERROR' ? 'log-error' : level === 'WARN' ? 'log-warning' : '';
            
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${logClass}`;
            logEntry.innerHTML = `
                <span class="log-time">[${time}]</span>
                <span class="log-level">[${level}]</span>
                <span>${message}</span>
            `;
            
            logsContainer.appendChild(logEntry);
            logsContainer.scrollTop = logsContainer.scrollHeight;
            
            // Keep only last 50 logs
            while (logsContainer.children.length > 50) {
                logsContainer.removeChild(logsContainer.firstChild);
            }
        }

        function updateMetric(id, value) {
            document.getElementById(id).textContent = value;
        }

        function updateStatus() {
            // Update system status indicators
            const healthValue = parseInt(document.getElementById('systemHealth').textContent);
            const healthIndicators = document.querySelectorAll('.health-indicator');
            
            healthIndicators.forEach(indicator => {
                indicator.className = 'health-indicator ' + 
                    (healthValue >= 90 ? 'health-good' : 
                     healthValue >= 70 ? 'health-warning' : 'health-critical');
            });
        }

        function loadSystemStatus() {
            // Simulate loading system status
            updateMetric('systemHealth', 95);
            updateMetric('activeTasks', 3);
            updateMetric('completedToday', 12);
            updateMetric('errorCount', 1);
            updateStatus();
        }

        function refreshAll() {
            addLog('INFO', '🔄 تحديث شامل للنظام...');
            loadSystemStatus();
            setTimeout(() => {
                addLog('INFO', '✅ تم التحديث الشامل');
            }, 1000);
        }

        function startAutoRefresh() {
            if (autoRefresh) {
                setInterval(() => {
                    if (systemRunning) {
                        // Simulate system activity
                        const activities = [
                            '📊 تحديث المقاييس',
                            '🔍 فحص الأخطاء',
                            '📋 معالجة المهام',
                            '💾 حفظ التقارير'
                        ];
                        const randomActivity = activities[Math.floor(Math.random() * activities.length)];
                        addLog('INFO', randomActivity);
                        
                        // Random metric updates
                        if (Math.random() > 0.7) {
                            updateMetric('completedToday', parseInt(document.getElementById('completedToday').textContent) + 1);
                        }
                    }
                }, 10000); // Every 10 seconds
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey) {
                switch(e.key) {
                    case 'r':
                        e.preventDefault();
                        refreshAll();
                        break;
                    case 's':
                        e.preventDefault();
                        startAutoSystem();
                        break;
                    case 'p':
                        e.preventDefault();
                        pauseSystem();
                        break;
                }
            }
        });
    </script>
</body>
</html>