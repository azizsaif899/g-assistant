# ุชูุฑูุฑ ุดุงูู ูุฎุทุฉ ุนูู: ุญู ูุดููุฉ `TypeError: Cannot read properties of undefined (reading 'handleRequest')`

## ููุฎุต ุชูููุฐู

ุงูุฎุทุฃ ุงููุชูุฑุฑ `TypeError: Cannot read properties of undefined (reading 'handleRequest')` ููุณ ูุฌุฑุฏ ุฎูู ุจุฑูุฌู ุจุณูุทุ ุจู ูู ุนุฑุถ ููุดููุฉ ูุนูุงุฑูุฉ ุฃุนูู ูู ุงููุดุฑูุน. ุงูุณุจุจ ุงูุฌุฐุฑู ูู ุบูุงุจ ุงูุชูุญูุฏ ุงูููุงุณู ูู ููููุฉ ุงุณุชุฏุนุงุก ุงููุญุฏุงุช ูุงููููุงุกุ ููุง ุฃุฏู ุฅูู ูุธุงู ูุด ูุบูุฑ ูุงุจู ููุตูุงูุฉ.

ูุฐู ุงููุซููุฉ ุชูุถุญ ุงูุฃุณุจุงุจ ุงูุฌุฐุฑูุฉ ูุชูุฏู ุฎุทุฉ ุนูู ููุงุฆูุฉ ูุฅุนุงุฏุฉ ููููุฉ ุงูุฃุฌุฒุงุก ุงููุชุถุฑุฑุฉุ ููุง ูุถูู ุงุณุชูุฑุงุฑ ุงููุธุงู ููุงุจููุชู ููุชุทููุฑ ูุณุชูุจููุง.

---

## 1. ุชุญููู ุงูุฃุณุจุงุจ ุงูุฌุฐุฑูุฉ

### ุงูุณุจุจ ุงูุฃูู (ุงูุฃุฎุทุฑ): ุงุณุชุฏุนุงุก ูุจุงุดุฑ ูููุคูุชุงุช ุงูุฒูููุฉ (Direct Trigger Invocation)

- **ุงููุดููุฉ:** ูุงูุช ุงููุคูุชุงุช ุงูุฒูููุฉ ูู `0_agent_triggers.js` (ูุซู `devWeeklyTrigger`) ุชุณุชุฏุนู ุฏูุงููุง ูุญุฏุฏุฉ ุฏุงุฎู ุงููููุงุก ูุจุงุดุฑุฉ (`System.AgentDeveloper.runWeeklyCodeReview()`). ูุฐุง ุงูุฃุณููุจ ูุชุฌุงูุฒ ุงููุงุฌูุฉ ุงูููุญุฏุฉ `handleRequest` ูููุฒุน ุงููููุงุก `AgentDispatcher`.
- **ุงูุฃุซุฑ:** ุนูุฏูุง ูุนูู ุงููุคูุชุ ูุฏ ูุง ูููู ุงููุงุฆู `System.AgentDeveloper` ูุฏ ุชู ุชุญูููู ุฃู ุชููุฆุชู ุจุงููุงูู ุจูุงุณุทุฉ ูุธุงู `defineModule` ูู ุชูู ุงููุญุธุฉุ ููุง ูุคุฏู ุฅูู ุฃู ูููู `System.AgentDeveloper` ุบูุฑ ูุนุฑู (`undefined`)ุ ูุจุงูุชุงูู ูุญุฏุซ ุงูุฎุทุฃ `Cannot read properties of undefined`. ูุฐุง ููุณุฑ ููุงุฐุง ูุธูุฑ ุงูุฎุทุฃ ุจุดูู ูุชูุทุน ูุบูุฑ ูุชููุน.

### ุงูุณุจุจ ุงูุซุงูู: ุชูุฑุงุฑ ุงูููุทู ูุบูุงุจ ุงููุฑูุฒูุฉ

- **ุงููุดููุฉ:** ูู `agent_developer.gs.js`ุ ูุงูุช ุฏุงูุฉ `runWeeklyCodeReview` ุชุนูุฏ ุจูุงุก ููุทู ูุงูู ูุฅุฑุณุงู ุทูุจ ูุฑุงุฌุนุฉ ููุฏ ุฅูู ุงููููุฐุฌุ ูุชุฌุงููุฉ ูุฌูุฏ ุฏุงูุฉ ูุชุฎุตุตุฉ ูุฃูุซุฑ ููุฉ ููู `AI.Core.askForCodeAnalysis`.
- **ุงูุฃุซุฑ:** ูุฐุง ุงูุชูุฑุงุฑ ูุคุฏู ุฅูู ุชุจุงูู ูู ุฌูุฏุฉ ุงูุชุญูููุ ุตุนูุจุฉ ูู ุงูุตูุงูุฉุ ูุนุฏู ุงูุงุณุชูุงุฏุฉ ูู ุงูุชุญุณููุงุช ุงูุชู ุชุชู ุนูู ุงูุฏุงูุฉ ุงููุฑูุฒูุฉ.

### ุงูุณุจุจ ุงูุซุงูุซ: ุฃุฎุทุงุก ูุงููุฉ ููุดุงุดุฉ ูู ุงูููุฏ

- **ุงููุดููุฉ:** ุฎูุงู ุงููุญุต ุงูุดุงููุ ุชู ุงูุชุดุงู ุฃุฎุทุงุก ุจุฑูุฌูุฉ ุฃุฎุฑู ูุงูุช ุณุชุธูุฑ ุญุชููุง:
    1.  **ุฎุทุฃ ูู ูุญุฏุฉ ุงูุชุตุฏูุฑ (`99_export_project.gs.js`):** ุงุณุชุฏุนุงุก ูุชุบูุฑ ุบูุฑ ููุฌูุฏ (`scriptFile`) ูุงู ุณูุคุฏู ุฅูู ูุดู ุนูููุฉ ุงูุชุตุฏูุฑ.
    2.  **ุนุฏู ุงุชุณุงู ูู ูุงุฌูุฉ ุงููููุงุก (`agent_cfo.gs.js`):** ุงุฎุชูุงู ูู ุทุฑููุฉ ุงููุตูู ุฅูู `toolName` ุจูู ุงููููุงุกุ ููุง ูุถุนู ุงูุจููุฉ ุงูุนุงูุฉ.
- **ุงูุฃุซุฑ:** ูุฐู ุงูุฃุฎุทุงุก ุชููู ูู ููุซูููุฉ ุงููุธุงู ูุชุฒูุฏ ูู ุงุญุชูุงููุฉ ุญุฏูุซ ุฃุนุทุงู ูู ุงููุณุชูุจู.

---

## 2. ุฎุทุฉ ุงูุนูู ุงูุชุตุญูุญูุฉ

1.  **ุชูุญูุฏ ุงุณุชุฏุนุงุกุงุช ุงููุคูุชุงุช (Highest Priority):**
    - **ุงูุฅุฌุฑุงุก:** ุชุนุฏูู ุฌููุน ุฏูุงู ุงููุคูุชุงุช ูู `0_agent_triggers.js` ูุชุชููู ุนู ุงูุงุณุชุฏุนุงุก ุงููุจุงุดุฑ.
    - **ุงูุขููุฉ:** ุณุชุณุชุฎุฏู ุงููุคูุชุงุช ุงูููุฒุน ุงููุฑูุฒู `GAssistant.Agents.Dispatcher.dispatch` ูุฅุฑุณุงู "ููุฉ" (Intent) ูุงุถุญุฉ (ูุซู `{ type: 'tool_call', toolName: 'Developer.runWeeklyCodeReview' }`).
    - **ุงููุชูุฌุฉ:** ุถูุงู ุฃู ุฌููุน ุงูุทูุจุงุช ุชูุฑ ุนุจุฑ ุงููุณุงุฑ ุงูุตุญูุญุ ููุง ููุถู ุนูู ุฃุฎุทุงุก ุงูุชุญููู ุบูุฑ ุงููุชุฒุงูู.

2.  **ุฅุนุงุฏุฉ ููููุฉ ูููู ุงููุทูุฑ (`AgentDeveloper`):**
    - **ุงูุฅุฌุฑุงุก:** ุชุนุฏูู ุฏุงูุฉ `runWeeklyCodeReview` ูุชุนุชูุฏ ุจุดูู ูุงูู ุนูู `AI.Core.askForCodeAnalysis`.
    - **ุงููุชูุฌุฉ:** ูุฑูุฒูุฉ ููุทู ุชุญููู ุงูููุฏุ ุชุจุณูุท ุงูุตูุงูุฉุ ูุถูุงู ุชุทุจูู ุฃู ุชุญุณููุงุช ูุณุชูุจููุฉ ูู ูู ููุงู.

3.  **ุฅุตูุงุญุงุช ุงุณุชุจุงููุฉ ูุฒูุงุฏุฉ ุงูุงุณุชูุฑุงุฑ:**
    - **ุงูุฅุฌุฑุงุก:** ุฅุตูุงุญ ุงูุฎุทุฃ ูู `99_export_project.gs.js` ุจุงุณุชุฎุฏุงู ูุตุฏุฑ ููุซูู ูุงุณู ุงููุดุฑูุน ูู `Config`.
    - **ุงูุฅุฌุฑุงุก:** ุชูุญูุฏ ูุงุฌูุฉ ุงุณุชุฏุนุงุก ุงูุฃุฏูุงุช ุฏุงุฎู ุฌููุน ุงููููุงุก ูุชููู ูุชุณูุฉ.
    - **ุงููุชูุฌุฉ:** ูุธุงู ุฃูุซุฑ ููุฉ ูููุซูููุฉ ูุฃูู ุนุฑุถุฉ ููุฃุฎุทุงุก ุงููุงููุฉ.

ุฃูููุช ุจูุงุก ูุณุฎุฉ ุชุดุบูููุฉ ูุณุชููุฉ ูู ูุธุงู "AzizSys" ุฎุงุฑุฌ ุจูุฆุฉ Google Apps Script ุนุจุฑ:

- ุจูุงุก ูุญุฑู ุชุญููู ุฌุฏูุฏ `core_loader.js` ูุฏุนู defineModule ู Injector ุจุดูู ูุณุชูู
- ุชูููุฑ ูุญุงูุงุฉ ูุฎุฏูุงุช GAS ุนุจุฑ `gas_mocks.js`
- ุชูุซูู ุงููุญุฏุงุช ูุงููููุงุช ูู `azizsys_manifest.json` ู `module_docs.json`
- ุฅูุดุงุก ููุทุฉ ุชุดุบูู ุชุฌุฑูุจูุฉ ุนุจุฑ `AzizSysRunner.js`
- ุฅุตุฏุงุฑ ุชูุฑูุฑ ุชูุงูููุฉ ุจุงุณู `PORTABILITY_REPORT.md` ูุญุชูู ูุชุงุฆุฌ ุงูุชุฌุฑุจุฉ

ุงููุฑุญูุฉ ุงูุชุงููุฉ ูู ุงูุชุทููุฑ ุชุนุชูุฏ ุนูู ูุฐู ุงููุชุงุฆุฌุ ูุงููุทููุจ:

---

### โ ุฃูููุง: ุชูุนูู ุงุฎุชุจุงุฑุงุช ุชูุงูู ูููุญุฏุงุช ุงูุฃุณุงุณูุฉ

1. ุจูุงุก ูุฌูุฏ `tests/` ูุญุชูู ุงุฎุชุจุงุฑุงุช ููุญุฏุงุช:
   - `utils.js`
   - `config.js`
   - `AI.Core`
   - `AgentsRouter`

2. ุงุณุชุฎุฏุงู ุฅุทุงุฑ ุงุฎุชุจุงุฑ ูุซู `Vitest` ุฃู `Jest` ูุชุฃููุฏ ุฃู Injector ูุนูู ุจููุงุกุฉ

---

### ๐ก๏ธ ุซุงูููุง: ุชุญููู ูุญุฏุงุช ูุง ุชุฒุงู ุชุนุชูุฏ ุนูู GAS APIs

1. ูุญุต ูู ูุญุฏุฉ ุฏุงุฎู `src/azizsys_core` ูููุดู ุนู:
   - ุงุณุชุฎุฏุงู `SpreadsheetApp`, `PropertiesService`, `Logger` ุงูุฃุตูู
   - ุฃูุฉ ุฏูุงู ุบูุฑ ูุญููุฉ ุนูุฏ ุงูุชุดุบูู ุฎุงุฑุฌ GAS

2. ุชุญุฏูุซ `gas_mocks.js` ูุฏุนู ุงููุฒูุฏ ูู ุงูุญุงูุงุช

---

### ๐ฆ ุซุงูุซูุง: ุชุญููู ุงููุญุฏุงุช ุฅูู ESModules ุจุงููุงูู

- ุชุนุฏูู `defineModule(...)` ููุชู ุชุตุฏูุฑ ุงููุญุฏุงุช ุนุจุฑ `export` ุนูุฏ ุชููุฑ ุงูุจูุฆุฉ
- ููู ุงููุธุงู ุฅูู ุจููุฉ `src/modules/{domain}/{name}.js`
- ุชูููุฏ ููู `azizsys_exports.js` ูุญุชูู ูู ุงููุญุฏุงุช ุงููุงุจูุฉ ููุงุณุชุฎุฏุงู ุงูุนุงู

---

### ๐งฉ ุฑุงุจุนูุง: ุชูุซูู ูุชุญููู ุงูุงุณุชููุงููุฉ

- ุจูุงุก ุชูุฑูุฑ `AZIZSYS_PORTABILITY_MATRIX.md` ูุญุชูู:
   - ูุฏู ุงุณุชููุงู ูู ูุญุฏุฉ ุนู GAS
   - ุชุจุนูุงุช ุฏุงุฎููุฉ ููู ููู
   - ุฌุงูุฒูุฉ ูููุตูู ุนุจุฑ npm ุฃู bundling

---

### ๐ ุงููุฏู ุงูููุงุฆู:

ุจูุงุก ููุชุจุฉ ููุฏุณูุฉ ุงุณููุง `azizsys-core`ุ ูููู ูุดุฑูุงุ ุงุณุชุฎุฏุงููุง ุฏุงุฎู ุชุทุจููุงุช Webุ Node.jsุ ุฃู ุฏูุฌูุง ูู ูุธู ุฎุงุฑุฌูุฉ ุฏูู ุฃู ุงุฑุชุจุงุท ุจูุฆุฉ ูุญุฏุฏุฉ.
