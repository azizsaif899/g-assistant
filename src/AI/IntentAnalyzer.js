/**
 * @module System.AI.IntentAnalyzer
 * @description تم تحويله تلقائياً بواسطة ModuleFixer
 */
defineModule('System.AI.IntentAnalyzer', ({ AI }) => {
  // === المحتوى الأصلي ===
  
  /**
   * @file 20_ai/3_intentAnalyzer.gs
   * @module System.AI.IntentAnalyzer
   * @version 2.0.0
   * @author عبدالعزيز
   * @description
   * وحدة تحليل نية المستخدم. تتبنى نهجًا هجينًا:
   * 1.  **المسار السريع (Regex):** تستخدم تعبيرات نمطية للأوامر الواضحة والمباشرة لتوفير استجابة سريعة.
   * 2.  **المسار الذكي (AI):** عند فشل المسار السريع، تستدعي نموذج Gemini لتحليل اللغة الطبيعية المعقدة وتحديد النية والأداة المناسبة.
   */
  
  
  
  const MODULE_VERSION = Config.get('AI_INTENT_ANALYZER_VERSION') || '2.0.0';
    const METRICS_SHEET = 'AI_IntentAnalyzer_Metrics';
  
    // تعريف النوايا القائمة على القواعد (Regex)
    // هذه النوايا هي لـ "المعالجة السريعة" التي لا تتطلب استدعاء LLM
    const INTENTS_RULES = {
      // نوايا عامة للنظام
      CLEAR_MEMORY: /(مسح الذاكرة|إعادة تعيين الذاكرة|امسح ذاكرتي)/i,
      GET_VERSION: /(ما هو إصدارك|معلومات عنك|إصدارك|نسختك)/i,
  
      // نوايا خاصة بالمطور (توجيه لـ Tools.Developer)
      CODE_REVIEW: /(راجع الكود|مراجعة الكود|فحص الكود)/i,
      GENERATE_CODE: /(إنشاء كود|توليد كود|اكتب كود|اكتب لي دالة)/i,
      REFACTOR_CODE: /(إعادة هيكلة الكود|تحسين الكود|هيكل الكود)/i,
      ADD_COMMENTS: /(أضف تعليقات|تعليق على الكود)/i,
      EXPLAIN_CODE: /(اشرح الكود|شرح الكود|كيف يعمل هذا الكود)/i,
      LIST_FILES: /(عرض الملفات|قائمة الملفات|أظهر لي الملفات)/i,
      RUN_FUNCTION: /(تشغيل الدالة|نفذ الدالة|استدعي الدالة)\s+([a-zA-Z0-9_.]+)/i, // يتطلب استخراج اسم الدالة
      // يمكن إضافة المزيد من القواعد هنا
  }
  

  // === التصدير ===
  return {
    // أضف الدوال والمتغيرات التي تريد تصديرها هنا
  };
});